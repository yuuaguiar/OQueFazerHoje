{% extends 'gestao/base.html' %}
{% load static %}

{% block title %}Gerenciar - O Que Fazer Hoje.{% endblock %}

{% block content %}
<main class="config-grid">
    
    <div class="config-card">
        <h2 class="config-card-title">
            <i data-lucide="home" class="icon" style="display:inline; vertical-align:middle; margin-right:8px; width:20px;"></i>
            Gerenciar Cômodos
        </h2>
        
        <form action="{% url 'add_comodo' %}" method="POST" class="config-form">
            {% csrf_token %}
            <input type="text" name="nome" placeholder="Nome do novo cômodo..." class="form-input" style="flex:1;" required>
            <input type="hidden" name="icone" value="default.png">
            <button type="submit" class="btn btn-primary">
                <i data-lucide="plus" class="icon" style="width:16px; margin-right:4px;"></i>
                Adicionar
            </button>
        </form>

        <div class="config-list">
            {% for comodo in comodos %}
            <div class="config-list-item">
                <span>{{ comodo.nome }}</span>
                <form action="{% url 'delete_comodo' comodo.id %}" method="POST">
                    {% csrf_token %}
                    <button type="submit" class="btn-icon" aria-label="Deletar" title="Excluir Cômodo">
                        <i data-lucide="trash-2" class="icon"></i>
                    </button>
                </form>
            </div>
            {% empty %}
            <div style="text-align: center; padding: 1rem; color: hsl(var(--muted-foreground));">
                Nenhum cômodo cadastrado.
            </div>
            {% endfor %}
        </div>
    </div>

    <div class="config-card">
        <h2 class="config-card-title">
            <i data-lucide="check-square" class="icon" style="display:inline; vertical-align:middle; margin-right:8px; width:20px;"></i>
            Criar Nova Tarefa
        </h2>
        
        <form action="{% url 'add_tarefa' %}" method="POST" style="display: grid; gap: 1.25rem;">
            {% csrf_token %}
            
            <div>
                <label class="form-label">Nome da Tarefa</label>
                <input type="text" name="titulo" placeholder="Ex: Lavar a louça" class="form-input" required>
            </div>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                <div>
                    <label class="form-label">Cômodo</label>
                    <select name="comodo_id" class="form-select" required>
                        <option value="" disabled selected>Selecione...</option>
                        {% for comodo in comodos %}
                        <option value="{{ comodo.id }}">{{ comodo.nome }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div>
                    <label class="form-label">Frequência (dias)</label>
                    <input type="number" name="intervalo_dias" value="1" min="1" class="form-input" required>
                </div>
            </div>
            
            <button type="submit" class="btn btn-primary" style="width: 100%; justify-content: center;">
                Confirmar e Criar Tarefa
            </button>
        </form>
    </div>
</main>

<script>
    if (typeof lucide !== "undefined") {
        lucide.createIcons();
    }
</script>
{% endblock %}